/******************************************************************************\
 *                                                                            * 
 *  Libcutils - library of C function                                         * 
 *                                                                            *
 *  Version:             3.4                                                  * 
 *  Date:                28/01/2017                                           *
 *                                                                            * 
 *  Author:              Zdenek Futera                                        * 
 *                                                                            * 
 *  Address:             University College London (UCL)                      * 
 *                       Department of Physics and Astronomy                  * 
 *                       Gower Street, London WC1E 6BT                        * 
 *                       United Kingdom                                       * 
 *                                                                            * 
 *  E-Mail:              z.futera@ucl.ac.uk                                   * 
 *                                                                            * 
\******************************************************************************/

#include <stdlib.h>
#include <cmn/list.h>
#include <cmn/message.h>
#include <cmn/string.h>
#include "mol/aacid.h"
#include "mol/atom.h"
#include "mol/molec.h"

/* -------------------------------------------------------------------------- */

/* type of 'aacid_geom_def_add' function */
typedef void(*zmt_add_fce)(struct list*, char*, char*, 
  unsigned, double, unsigned, double, unsigned, double);

/*----------------------------------------------------------------------------*/

/* Add one line into Z-matrix definition
 
   zm    - z-matrix data
   sym   - atomic symbol
   name  - atomic name (PDB)
   id_b  - bond atom ID
   val_b - bond legth
   id_a  - angle atom ID
   val_a - angle value
   id_d  - dihedral atom ID
   val_d - dihedral value */
void aacid_geom_def_add(struct list *zm, char *sym, char *name, unsigned id_b,
  double val_b, unsigned id_a, double val_a, unsigned id_d, double val_d) {
  struct zmt_atom *a;
  /* create new data structure */
  a = mol_zmt_atom_new(1);
  /* atom */
  a->name = str_copy_new(name);
  a->num = atom_num(sym);
  /* bond */
  if (zm->num>0 && id_b<1)
    msg_error_f("invalid Z-matrix bond ID (%d) of atom %ld (%s)",
      1,id_b,zm->num+1,sym);
  a->bond_id = id_b-1;
  a->bond_val = val_b;
  /* angle */
  if (zm->num>1 && id_a<1)
    msg_error_f("invalid Z-matrix angle ID (%d) of atom %ld (%s)",
      1,id_a,zm->num+1,sym);
  a->angle_id = id_a-1;
  a->angle_val = val_a;
  /* dihedral */
  if (zm->num>2 && id_d<1)
    msg_error_f("invalid Z-matrix dihedral ID (%d) of atom %ld (%s)",
      1,id_d,zm->num+1,sym);
  a->dihed_id = id_d-1;
  a->dihed_val = val_d;
  /* add data to z-matrix */
  list_add_end_p(zm,a);
  }

/*----------------------------------------------------------------------------*/

/* Create Z-matrix list definition of alanine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_ala(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.109, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.469, 2,113.076, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.961, 2, -59.092); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.775, 2,  57.750); /*  5 */
      zm_add(z,"C"," C  ", 1,1.526, 2,104.783, 3, 118.621); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,126.280, 2, 103.679); /*  7 */
      zm_add(z,"O"," OH ", 6,1.359, 1,111.327, 2, -74.040); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.105, 1, 179.600); /*  9 */
      zm_add(z,"C"," CB ", 1,1.526, 2,108.575, 6, 118.486); /* 10 */
      zm_add(z,"H"," HB1",10,1.093, 1,110.818, 2, -58.287); /* 11 */
      zm_add(z,"H"," HB2",10,1.094, 1,110.129, 2,-178.556); /* 12 */
      zm_add(z,"H"," HB3",10,1.096, 1,110.053, 2,  61.809); /* 13 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.092, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.514, 2,106.949, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.070, 2,  -6.905); /*  4 */
      zm_add(z,"H"," HN1", 3,1.067, 1, 99.838, 2, 111.713); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,113.339, 2,-131.155); /*  6 */
      zm_add(z,"C"," C  ", 1,1.572, 2,108.571, 3, 112.665); /*  7 */
      zm_add(z,"O"," O  ", 7,1.242, 1,116.262, 2,  68.645); /*  8 */
      zm_add(z,"O"," OXT", 7,1.270, 1,114.214, 2,-110.927); /*  9 */
      zm_add(z,"C"," CB ", 1,1.523, 2,110.486, 3,-122.290); /* 10 */
      zm_add(z,"H"," HB1",10,1.092, 1,108.190, 2, -64.776); /* 11 */
      zm_add(z,"H"," HB2",10,1.096, 1,111.153, 2, 176.848); /* 12 */
      zm_add(z,"H"," HB3",10,1.095, 1,111.891, 2,  54.914); /* 13 */
      break;
    default:
      msg_error("invalid form of alanine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of arginine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_arg(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.472, 2,113.012, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.915, 2, -60.475); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.608, 2,  56.181); /*  5 */
      zm_add(z,"C"," C  ", 1,1.528, 2,105.718, 3, 116.996); /*  6 */
      zm_add(z,"O"," O  ", 6,1.210, 1,127.128, 2, 115.493); /*  7 */
      zm_add(z,"O"," OH ", 6,1.359, 1,110.739, 2, -63.999); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.215, 1,-178.515); /*  9 */
      zm_add(z,"C"," CB ", 1,1.532, 2,108.773, 6, 120.478); /* 10 */
      zm_add(z,"H"," HB2",10,1.096, 1,108.481, 2,-169.575); /* 11 */
      zm_add(z,"H"," HB3",10,1.099, 1,107.460, 2,  75.410); /* 12 */
      zm_add(z,"C"," CG ",10,1.533, 1,114.329, 2, -45.767); /* 13 */
      zm_add(z,"H"," HG2",13,1.099,10,110.235, 1,  55.370); /* 14 */
      zm_add(z,"H"," HG3",13,1.097,10,108.916, 1, -61.803); /* 15 */
      zm_add(z,"C"," CD ",13,1.530,10,111.942, 1, 176.582); /* 16 */
      zm_add(z,"H"," HD2",16,1.102,13,110.331,10,  54.633); /* 17 */
      zm_add(z,"H"," HD3",16,1.093,13,111.180,10, -63.038); /* 18 */
      zm_add(z,"N"," NE ",16,1.459,13,110.477,10, 178.311); /* 19 */
      zm_add(z,"H"," HE ",19,1.014,16,113.727,13, -51.950); /* 20 */
      zm_add(z,"C"," CZ ",19,1.388,16,119.439,13, 167.159); /* 21 */
      zm_add(z,"N"," NH1",21,1.285,19,120.701,16,  -6.641); /* 22 */
      zm_add(z,"H","HH11",22,1.022,21,110.377,19,-171.413); /* 23 */
      zm_add(z,"N"," NH2",21,1.404,19,113.364,16, 178.057); /* 24 */
      zm_add(z,"H","HH21",24,1.013,21,116.786,19, -16.468); /* 25 */
      zm_add(z,"H","HH22",24,1.012,21,114.155,19,-150.124); /* 26 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.514, 2,106.690, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.162, 2, -11.068); /*  4 */
      zm_add(z,"H"," HN1", 3,1.067, 1, 99.932, 2, 108.323); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,113.223, 2,-135.379); /*  6 */
      zm_add(z,"C"," C  ", 1,1.575, 2,108.533, 3, 112.048); /*  7 */
      zm_add(z,"O"," O  ", 7,1.243, 1,116.994, 2,  70.433); /*  8 */
      zm_add(z,"O"," OXT", 7,1.269, 1,113.988, 2,-108.594); /*  9 */
      zm_add(z,"C"," CB ", 1,1.534, 2,110.161, 3,-120.464); /* 10 */
      zm_add(z,"H"," HB2",10,1.098, 1,109.204, 2,-173.041); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,108.702, 2,  70.506); /* 12 */
      zm_add(z,"C"," CG ",10,1.534, 1,112.906, 2, -50.501); /* 13 */
      zm_add(z,"H"," HG2",13,1.097,10,109.724, 1,  59.743); /* 14 */
      zm_add(z,"H"," HG3",13,1.094,10,108.702, 1, -57.646); /* 15 */
      zm_add(z,"C"," CD ",13,1.529,10,111.103, 1,-179.536); /* 16 */
      zm_add(z,"H"," HD2",16,1.098,13,110.202,10,  57.472); /* 17 */
      zm_add(z,"H"," HD3",16,1.095,13,110.159,10, -61.829); /* 18 */
      zm_add(z,"N"," NE ",16,1.468,13,110.071,10, 178.837); /* 19 */
      zm_add(z,"H"," HE ",19,1.012,16,117.280,13, -24.293); /* 20 */
      zm_add(z,"C"," CZ ",19,1.336,16,125.119,13, 163.165); /* 21 */
      zm_add(z,"N"," NH1",21,1.340,19,120.398,16,   2.750); /* 22 */
      zm_add(z,"H","HH11",22,1.010,21,120.450,19,-177.233); /* 23 */
      zm_add(z,"H","HH12",22,1.010,21,120.946,19,  19.399); /* 24 */
      zm_add(z,"N"," NH2",21,1.340,19,119.821,16,-176.244); /* 25 */
      zm_add(z,"H","HH21",25,1.010,21,120.955,19,  14.573); /* 26 */
      zm_add(z,"H","HH22",25,1.010,21,121.030,19,-176.870); /* 27 */
      break;
    default:
      msg_error("invalid form of arginine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of asparagine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_asn(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.107, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.465, 2,113.108, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,106.484, 2, -54.899); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.380, 2,  60.933); /*  5 */
      zm_add(z,"C"," C  ", 1,1.524, 2,105.296, 3, 120.532); /*  6 */
      zm_add(z,"O"," O  ", 6,1.211, 1,126.145, 2,  99.724); /*  7 */
      zm_add(z,"O"," OH ", 6,1.356, 1,111.504, 2, -77.786); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.145, 1, 178.976); /*  9 */
      zm_add(z,"C"," CB ", 1,1.530, 2,107.849, 6, 117.371); /* 10 */
      zm_add(z,"H"," HB2",10,1.095, 1,109.923, 2, -68.729); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,108.551, 2, 174.547); /* 12 */
      zm_add(z,"C"," CG ",10,1.526, 1,112.106, 2,  54.216); /* 13 */
      zm_add(z,"O"," OD1",13,1.227,10,123.388, 1,  10.226); /* 14 */
      zm_add(z,"N"," ND2",13,1.364,10,114.771, 1,-169.546); /* 15  */
      zm_add(z,"H","HD21",15,1.009,13,122.373,10,  -4.335); /* 16 */
      zm_add(z,"H","HD22",15,1.010,13,118.283,10,-174.835); /* 17 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.095, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.505, 2,104.883, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.026, 1,110.702, 2, -44.269); /*  4 */
      zm_add(z,"H"," HN1", 3,1.038, 1,104.095, 2,  80.807); /*  5 */
      zm_add(z,"H"," HN2", 3,1.024, 1,111.593, 2,-164.345); /*  6 */
      zm_add(z,"C"," C  ", 1,1.568, 2,107.664, 3, 113.045); /*  7 */
      zm_add(z,"O"," O  ", 7,1.246, 1,116.300, 2,  86.964); /*  8 */
      zm_add(z,"O"," OXT", 7,1.263, 1,113.571, 2, -90.756); /*  9 */
      zm_add(z,"C"," CB ", 1,1.519, 2,109.599, 3,-119.738); /* 10 */
      zm_add(z,"H"," HB2",10,1.093, 1,107.685, 2, -69.339); /* 11 */
      zm_add(z,"H"," HB3",10,1.099, 1,110.658, 2, 175.055); /* 12 */
      zm_add(z,"C"," CG ",10,1.528, 1,112.042, 2,  53.548); /* 13 */
      zm_add(z,"O"," OD1",13,1.238,10,121.744, 1,  19.896); /* 14 */
      zm_add(z,"N"," ND2",13,1.349,10,115.788, 1,-160.842); /* 15 */
      zm_add(z,"H","HD21",15,1.010,13,122.399,10,   1.144); /* 16 */
      zm_add(z,"H","HD22",15,1.011,13,119.391,10,-177.089); /* 17 */
      break;
    default:
      msg_error("invalid form of asparagine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of aspartic acid
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_asp(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.107, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.466, 2,113.186, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.018, 1,108.153, 2, -50.533); /*  4 */
      zm_add(z,"H"," HN ", 3,1.017, 1,109.465, 2,  65.792); /*  5 */
      zm_add(z,"C"," C  ", 1,1.526, 2,104.734, 3, 120.151); /*  6 */
      zm_add(z,"O"," O  ", 6,1.210, 1,125.819, 2,  96.957); /*  7 */
      zm_add(z,"O"," OH ", 6,1.356, 1,111.601, 2, -80.287); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.241, 1, 178.699); /*  9 */
      zm_add(z,"C"," CB ", 1,1.532, 2,108.348, 6, 116.592); /* 10 */
      zm_add(z,"H"," HB2",10,1.095, 1,109.825, 2, -63.754); /* 11 */
      zm_add(z,"H"," HB3",10,1.094, 1,109.729, 2, 179.723); /* 12 */
      zm_add(z,"C"," CG ",10,1.514, 1,116.269, 2,  58.127); /* 13 */
      zm_add(z,"O"," OD1",13,1.209,10,124.672, 1, 170.884); /* 14 */
      zm_add(z,"O"," OD2",13,1.364,10,113.442, 1, -10.139); /* 15 */
      zm_add(z,"H"," HD ",15,0.976,13,105.684,10,-178.896); /* 16 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.092, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.503, 2,108.213, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.083, 1,105.333, 2, -93.483); /*  4 */
      zm_add(z,"H"," HN1", 3,1.021, 1,112.390, 2,  27.298); /*  5 */
      zm_add(z,"H"," HN2", 3,1.038, 1,103.565, 2, 143.579); /*  6 */
      zm_add(z,"C"," C  ", 1,1.561, 2,110.768, 3, 117.870); /*  7 */
      zm_add(z,"O"," O  ", 7,1.249, 1,116.067, 2,  47.243); /*  8 */
      zm_add(z,"O"," OXT", 7,1.265, 1,114.629, 2,-135.286); /*  9 */
      zm_add(z,"C"," CB ", 1,1.541, 2,110.459, 3,-118.781); /* 10 */
      zm_add(z,"H"," HB2",10,1.092, 1,108.351, 2, -54.916); /* 11 */
      zm_add(z,"H"," HB3",10,1.101, 1,108.249, 2,-170.747); /* 12 */
      zm_add(z,"C"," CG ",10,1.553, 1,115.727, 2,  68.919); /* 13 */
      zm_add(z,"O"," OD1",13,1.244,10,118.053, 1,-141.119); /* 14 */
      zm_add(z,"O"," OD2",13,1.284,10,115.951, 1,  41.389); /* 15 */
      break;
    default:
      msg_error("invalid form of aspartic acid structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of cysteine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_cys(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.107, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.465, 2,113.127, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.018, 1,108.403, 2, -47.238); /*  4 */
      zm_add(z,"H"," HN ", 3,1.017, 1,109.581, 2,  69.016); /*  5 */
      zm_add(z,"C"," C  ", 1,1.527, 2,105.083, 3, 120.433); /*  6 */
      zm_add(z,"O"," O  ", 6,1.210, 1,125.630, 2,  97.431); /*  7 */
      zm_add(z,"O"," OH ", 6,1.356, 1,111.758, 2, -79.984); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.262, 1, 178.707); /*  9 */
      zm_add(z,"C"," CB ", 1,1.533, 2,107.944, 6, 116.497); /* 10 */
      zm_add(z,"H"," HB2",10,1.092, 1,109.922, 2, -55.828); /* 11 */
      zm_add(z,"H"," HB3",10,1.092, 1,110.130, 2,-174.665); /* 12 */
      zm_add(z,"S"," SG ",10,1.841, 1,113.541, 2,  62.528); /* 13 */
      zm_add(z,"H"," HG ",13,1.350,10, 96.595, 1,  77.452); /* 14 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.092, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.509, 2,106.837, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.529, 2, -15.965); /*  4 */
      zm_add(z,"H"," HN1", 3,1.066, 1, 99.790, 2, 103.698); /*  5 */
      zm_add(z,"H"," HN2", 3,1.024, 1,113.468, 2,-140.958); /*  6 */
      zm_add(z,"C"," C  ", 1,1.581, 2,108.196, 3, 112.440); /*  7 */
      zm_add(z,"O"," O  ", 7,1.241, 1,116.166, 2,  74.440); /*  8 */
      zm_add(z,"O"," OXT", 7,1.267, 1,113.695, 2,-104.343); /*  9 */
      zm_add(z,"C"," CB ", 1,1.520, 2,110.259, 3,-123.996); /* 10 */
      zm_add(z,"H"," HB2",10,1.091, 1,106.558, 2, -69.454); /* 11 */
      zm_add(z,"H"," HB3",10,1.094, 1,111.406, 2, 173.715); /* 12 */
      zm_add(z,"S"," SG ",10,1.845, 1,116.092, 2,  47.582); /* 13 */
      zm_add(z,"H"," HG ",13,1.350,10, 98.041, 1,  75.531); /* 14 */
      break;
    default:
      msg_error("invalid form of cysteine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of glutamic acid
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_glu(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.109, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.466, 2,112.949, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,109.214, 2, -55.206); /*  4 */
      zm_add(z,"H"," HN ", 3,1.017, 1,109.987, 2,  62.163); /*  5 */
      zm_add(z,"C"," C  ", 1,1.526, 2,103.971, 3, 119.157); /*  6 */
      zm_add(z,"O"," O  ", 6,1.210, 1,125.975, 2,  97.873); /*  7 */
      zm_add(z,"O"," OH ", 6,1.357, 1,111.587, 2, -79.069); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.247, 1, 178.504); /*  9 */
      zm_add(z,"C"," CB ", 1,1.536, 2,106.925, 6, 118.217); /* 10 */
      zm_add(z,"H"," HB2",10,1.093, 1,108.844, 2, -56.266); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,107.537, 2,  59.298); /* 12 */
      zm_add(z,"C"," CG ",10,1.539, 1,113.727, 2,-179.081); /* 13 */
      zm_add(z,"H"," HG2",13,1.097,10,108.836, 1,  66.408); /* 14 */
      zm_add(z,"H"," HG3",13,1.091,10,110.887, 1, -52.599); /* 15 */
      zm_add(z,"C"," CD ",13,1.511,10,113.117, 1,-173.770); /* 16 */
      zm_add(z,"O"," OE1",16,1.211,13,126.003,10, 127.500); /* 17 */
      zm_add(z,"O"," OE2",16,1.361,13,112.065,10, -52.945); /* 18 */
      zm_add(z,"H"," HE ",18,0.976,16,105.727,13,-179.376); /* 19 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.516, 2,106.357, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.021, 1,114.210, 2, -10.807); /*  4 */
      zm_add(z,"H"," HN1", 3,1.064, 1,100.062, 2, 108.562); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,112.685, 2,-135.087); /*  6 */
      zm_add(z,"C"," C  ", 1,1.570, 2,108.065, 3, 112.036); /*  7 */
      zm_add(z,"O"," O  ", 7,1.243, 1,116.366, 2,  70.334); /*  8 */
      zm_add(z,"O"," OXT", 7,1.270, 1,114.414, 2,-108.671); /*  9 */
      zm_add(z,"C"," CB ", 1,1.529, 2,109.926, 3,-122.353); /* 10 */
      zm_add(z,"H"," HB2",10,1.092, 1,106.655, 2, -61.438); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,109.352, 2,  53.242); /* 12 */
      zm_add(z,"C"," CG ",10,1.531, 1,115.631, 2, 178.164); /* 13 */
      zm_add(z,"H"," HG2",13,1.100,10,109.358, 1,  53.214); /* 14 */
      zm_add(z,"H"," HG3",13,1.099,10,112.357, 1, -64.320); /* 15 */
      zm_add(z,"C"," CD ",13,1.563,10,113.819, 1, 173.391); /* 16 */
      zm_add(z,"O"," OE1",16,1.260,13,115.541,10, 156.618); /* 17 */
      zm_add(z,"O"," OE2",16,1.260,13,116.777,10, -25.020); /* 18 */
      break;
    default:
      msg_error("invalid form of glutamic acid structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of glutamine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_gln(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.109, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.470, 2,113.124, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.018, 1,108.923, 2, -61.030); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.782, 2,  55.999); /*  5 */
      zm_add(z,"C"," C  ", 1,1.527, 2,105.497, 3, 117.407); /*  6 */
      zm_add(z,"O"," O  ", 6,1.211, 1,126.970, 2, 111.932); /*  7 */
      zm_add(z,"O"," OH ", 6,1.358, 1,110.951, 2, -67.068); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.245, 1,-178.963); /*  9 */
      zm_add(z,"C"," CB ", 1,1.531, 2,108.634, 6, 120.524); /* 10 */
      zm_add(z,"H"," HB2",10,1.096, 1,108.466, 2,  72.422); /* 11 */
      zm_add(z,"H"," HB3",10,1.095, 1,108.722, 2,-171.667); /* 12 */
      zm_add(z,"C"," CG ",10,1.532, 1,114.331, 2, -47.881); /* 13 */
      zm_add(z,"H"," HG2",13,1.100,10,109.800, 1,  49.783); /* 14 */
      zm_add(z,"H"," HG3",13,1.094,10,110.591, 1, -68.018); /* 15 */
      zm_add(z,"C"," CD ",13,1.529,10,111.260, 1, 167.467); /* 16 */
      zm_add(z,"O"," OE1",16,1.223,13,122.699,10, -38.646); /* 17 */
      zm_add(z,"N"," NE2",16,1.369,13,115.068,10, 143.927); /* 18 */
      zm_add(z,"H","HE21",18,1.011,16,117.669,13,-175.995); /* 19 */
      zm_add(z,"H","HE22",18,1.009,16,121.763,13, -13.913); /* 20 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.515, 2,107.029, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,113.837, 2,  -4.576); /*  4 */
      zm_add(z,"H"," HN1", 3,1.068, 1, 99.931, 2, 113.867); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,113.523, 2,-128.800); /*  6 */
      zm_add(z,"C"," C  ", 1,1.574, 2,108.935, 3, 112.432); /*  7 */
      zm_add(z,"O"," O  ", 7,1.243, 1,116.857, 2,  66.222); /*  8 */
      zm_add(z,"O"," OXT", 7,1.269, 1,114.171, 2,-113.415); /*  9 */
      zm_add(z,"C"," CB ", 1,1.533, 2,110.241, 3,-120.557); /* 10 */
      zm_add(z,"H"," HB2",10,1.096, 1,109.475, 2,  70.368); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,109.464, 2,-172.828); /* 12 */
      zm_add(z,"C"," CG ",10,1.531, 1,112.831, 2, -50.219); /* 13 */
      zm_add(z,"H"," HG2",13,1.100,10,109.624, 1,  56.799); /* 14 */
      zm_add(z,"H"," HG3",13,1.093,10,110.173, 1, -59.969); /* 15 */
      zm_add(z,"C"," CD ",13,1.526,10,111.816, 1, 175.637); /* 16 */
      zm_add(z,"O"," OE1",16,1.232,13,122.810,10, -25.145); /* 17 */
      zm_add(z,"N"," NE2",16,1.358,13,114.912,10, 155.442); /* 18 */
      zm_add(z,"H","HE21",18,1.011,16,119.122,13, 173.691); /* 19 */
      zm_add(z,"H","HE22",18,1.010,16,122.191,13,   3.078); /* 20 */
      break;
    default:
      msg_error("invalid form of glutamine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of glycine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_gly(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA2", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.461, 2,115.161, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.018, 1,109.360, 2, -56.714); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.641, 2,  60.321); /*  5 */
      zm_add(z,"C"," C  ", 1,1.517, 2,105.809, 3, 124.566); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,125.384, 2,  88.962); /*  7 */
      zm_add(z,"O"," OH ", 6,1.357, 1,111.798, 2, -87.921); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.100, 1, 178.753); /*  9 */
      zm_add(z,"H"," HA3", 1,1.093, 2,106.801, 6, 113.379); /* 10 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA2", 1,1.090, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.504, 2,109.506, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,113.882, 2,   2.507); /*  4 */
      zm_add(z,"H"," HN1", 3,1.066, 1, 99.786, 2, 120.223); /*  5 */
      zm_add(z,"H"," HN2", 3,1.022, 1,113.880, 2,-122.082); /*  6 */
      zm_add(z,"C"," C  ", 1,1.565, 2,111.205, 3, 117.103); /*  7 */
      zm_add(z,"O"," O  ", 7,1.241, 1,116.150, 2,  60.876); /*  8 */
      zm_add(z,"O"," OXT", 7,1.268, 1,113.851, 2,-119.137); /*  9 */
      zm_add(z,"H"," HA3", 1,1.090, 2,109.129, 3,-119.852); /* 10 */
      break;
    default:
      msg_error("invalid form of glycine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of histidine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_his(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.109, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.466, 2,113.599, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.021, 1,107.597, 2, -66.449); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.765, 2,  51.063); /*  5 */
      zm_add(z,"C"," C  ", 1,1.526, 2,105.175, 3, 119.483); /*  6 */
      zm_add(z,"O"," O  ", 6,1.211, 1,126.573, 2, 103.840); /*  7 */
      zm_add(z,"O"," OH ", 6,1.357, 1,111.277, 2, -73.927); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,105.961, 1, 179.765); /*  9 */
      zm_add(z,"C"," CB ", 1,1.538, 2,107.951, 6, 118.081); /* 10 */
      zm_add(z,"H"," HB2",10,1.098, 1,107.258, 2, 171.861); /* 11 */
      zm_add(z,"H"," HB3",10,1.093, 1,109.139, 2, -72.527); /* 12 */
      zm_add(z,"C"," CG ",10,1.501, 1,113.032, 2,  49.847); /* 13 */
      zm_add(z,"N"," ND1",13,1.386,10,122.085, 1,  50.461); /* 14 */
      zm_add(z,"C"," CE1",14,1.315,13,105.978,10, 179.817); /* 15 */
      zm_add(z,"H"," HE1",15,1.082,14,125.960,13, 179.954); /* 16 */
      zm_add(z,"N"," NE2",15,1.363,14,111.497,13,  -0.105); /* 17 */
      zm_add(z,"H"," HE2",17,1.010,15,126.517,14,-179.545); /* 18 */
      zm_add(z,"C"," CD2",13,1.374,10,128.308, 1,-129.691); /* 19 */
      zm_add(z,"H"," HD2",19,1.080,13,132.163,10,   0.182); /* 20 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.091, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.510, 2,108.196, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.042, 1,111.427, 2, -99.237); /*  4 */
      zm_add(z,"H"," HN1", 3,1.022, 1,112.108, 2,  22.738); /*  5 */
      zm_add(z,"H"," HN2", 3,1.048, 1,102.076, 2, 137.923); /*  6 */
      zm_add(z,"C"," C  ", 1,1.566, 2,111.008, 3, 116.354); /*  7 */
      zm_add(z,"O"," O  ", 7,1.246, 1,115.697, 2,  52.219); /*  8 */
      zm_add(z,"O"," OXT", 7,1.266, 1,114.461, 2,-130.046); /*  9 */
      zm_add(z,"C"," CB ", 1,1.541, 2,110.395, 3,-120.725); /* 10 */
      zm_add(z,"H"," HB2",10,1.099, 1,108.222, 2,-173.603); /* 11 */
      zm_add(z,"H"," HB3",10,1.093, 1,106.914, 2, -58.819); /* 12 */
      zm_add(z,"C"," CG ",10,1.500, 1,114.081, 2,  63.966); /* 13 */
      zm_add(z,"N"," ND1",13,1.389,10,120.155, 1,  57.981); /* 14 */
      zm_add(z,"C"," CE1",14,1.321,13,105.980,10,-179.823); /* 15 */
      zm_add(z,"H"," HE1",15,1.081,14,126.187,13, 179.772); /* 16 */
      zm_add(z,"N"," NE2",15,1.357,14,111.048,13,  -0.345); /* 17 */
      zm_add(z,"H"," HE2",17,1.011,15,126.009,14,-179.240); /* 18 */
      zm_add(z,"C"," CD2",13,1.373,10,130.313, 1,-122.014); /* 19 */
      zm_add(z,"H"," HD2",19,1.079,13,132.316,10,  -0.158); /* 20 */
      break;
    default:
      msg_error("invalid form of histidine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of isoleucine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_ile(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.475, 2,112.400, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.017, 1,109.163, 2, -52.044); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,108.767, 2,  63.481); /*  5 */
      zm_add(z,"C"," C  ", 1,1.530, 2,105.770, 3, 115.591); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,127.527, 2, 120.230); /*  7 */
      zm_add(z,"O"," OH ", 6,1.361, 1,110.575, 2, -60.130); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.052, 1,-177.969); /*  9 */
      zm_add(z,"C"," CB ", 1,1.546, 2,108.212, 6, 119.443); /* 10 */
      zm_add(z,"H"," HB ",10,1.098, 1,106.865, 2,-163.620); /* 11 */
      zm_add(z,"C"," CG2",10,1.538, 1,110.008, 2, -45.842); /* 12 */
      zm_add(z,"H","HG21",12,1.099,10,110.898, 1,  66.774); /* 13 */
      zm_add(z,"H","HG22",12,1.093,10,111.250, 1, -53.987); /* 14 */
      zm_add(z,"H","HG23",12,1.094,10,111.259, 1,-173.501); /* 15 */
      zm_add(z,"C"," CG1",10,1.543, 1,111.300, 2,  78.753); /* 16 */
      zm_add(z,"H","HG12",16,1.102,10,109.471, 1, -59.268); /* 17 */
      zm_add(z,"H","HG13",16,1.096,10,108.591, 1,  57.139); /* 18 */
      zm_add(z,"C"," CD1",16,1.534,10,114.382, 1, 177.872); /* 19 */
      zm_add(z,"H","HD11",19,1.095,16,112.312,10,  65.876); /* 20 */
      zm_add(z,"H","HD12",19,1.097,16,110.967,10, -54.802); /* 21 */
      zm_add(z,"H","HD13",19,1.096,16,110.579,10,-174.133); /* 22 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.517, 2,108.036, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,113.510, 2,  10.427); /*  4 */
      zm_add(z,"H"," HN1", 3,1.069, 1, 99.526, 2, 127.247); /*  5 */
      zm_add(z,"H"," HN2", 3,1.022, 1,114.472, 2,-114.260); /*  6 */
      zm_add(z,"C"," C  ", 1,1.577, 2,109.233, 3, 111.863); /*  7 */
      zm_add(z,"O"," O  ", 7,1.242, 1,117.187, 2,  50.583); /*  8 */
      zm_add(z,"O"," OXT", 7,1.271, 1,113.899, 2,-129.013); /*  9 */
      zm_add(z,"C"," CB ", 1,1.548, 2,110.076, 3,-120.309); /* 10 */
      zm_add(z,"H"," HB ",10,1.102, 1,106.938, 2, 172.975); /* 11 */
      zm_add(z,"C"," CG2",10,1.537, 1,111.508, 2, -69.200); /* 12 */
      zm_add(z,"H","HG21",12,1.097,10,110.676, 1,  63.901); /* 13 */
      zm_add(z,"H","HG22",12,1.090,10,111.468, 1, -55.954); /* 14 */
      zm_add(z,"H","HG22",12,1.094,10,110.216, 1,-176.782); /* 15 */
      zm_add(z,"C"," CG1",10,1.548, 1,110.880, 2,  54.945); /* 16 */
      zm_add(z,"H","HG12",16,1.099,10,108.381, 1, -67.678); /* 17 */
      zm_add(z,"H","HG13",16,1.099,10,110.562, 1,  47.689); /* 18 */
      zm_add(z,"C"," CD1",16,1.533,10,114.386, 1, 169.429); /* 19 */
      zm_add(z,"H","HD11",19,1.095,16,112.156,10,  63.898); /* 20 */
      zm_add(z,"H","HD12",19,1.097,16,111.066,10, -56.883); /* 21 */
      zm_add(z,"H","HD13",19,1.096,16,110.399,10,-176.276); /* 22 */
      break;
    default:
      msg_error("invalid form of isoleucine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of leucine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_leu(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.105, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.476, 2,112.452, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.750, 2, -61.040); /*  4 */
      zm_add(z,"H"," HN ", 3,1.019, 1,109.398, 2,  55.186); /*  5 */
      zm_add(z,"C"," C  ", 1,1.529, 2,105.776, 3, 115.549); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,127.502, 2, 123.164); /*  7 */
      zm_add(z,"O"," OH ", 6,1.360, 1,110.389, 2, -57.322); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.167, 1,-177.610); /*  9 */
      zm_add(z,"C"," CB ", 1,1.538, 2,110.007, 6, 121.324); /* 10 */
      zm_add(z,"H"," HB2",10,1.095, 1,108.172, 2,-149.180); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,107.561, 2,  96.201); /* 12 */
      zm_add(z,"C"," CG ",10,1.547, 1,116.366, 2, -25.130); /* 13 */
      zm_add(z,"H"," HG ",13,1.100,10,105.495, 1,-174.591); /* 14 */
      zm_add(z,"C"," CD1",13,1.537,10,113.488, 1, -57.586); /* 15 */
      zm_add(z,"H","HD11",15,1.098,13,111.555,10,  67.342); /* 16 */
      zm_add(z,"H","HD12",15,1.094,13,111.546,10, -52.898); /* 17 */
      zm_add(z,"H","HD13",15,1.097,13,110.484,10,-173.620); /* 18 */
      zm_add(z,"C"," CD2",13,1.538,10,112.228, 1,  69.360); /* 19 */
      zm_add(z,"H","HD21",19,1.096,13,110.827,10, 175.153); /* 20 */
      zm_add(z,"H","HD22",19,1.097,13,111.409,10,  55.248); /* 21 */
      zm_add(z,"H","HD23",19,1.098,13,111.904,10, -65.409); /* 22 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.092, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.515, 2,106.835, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.021, 1,114.393, 2,  -8.492); /*  4 */
      zm_add(z,"H"," HN1", 3,1.071, 1, 99.349, 2, 109.758); /*  5 */
      zm_add(z,"H"," HN2", 3,1.022, 1,113.630, 2,-133.574); /*  6 */
      zm_add(z,"C"," C  ", 1,1.578, 2,107.689, 3, 111.453); /*  7 */
      zm_add(z,"O"," O  ", 7,1.242, 1,116.547, 2,  69.903); /*  8 */
      zm_add(z,"O"," OXT", 7,1.270, 1,114.066, 2,-109.342); /*  9 */
      zm_add(z,"C"," CB ", 1,1.530, 2,111.103, 3,-124.637); /* 10 */
      zm_add(z,"H"," HB2",10,1.095, 1,104.741, 2, -78.084); /* 11 */
      zm_add(z,"H"," HB3",10,1.100, 1,108.742, 2, 168.836); /* 12 */
      zm_add(z,"C"," CG ",10,1.546, 1,118.313, 2,  43.089); /* 13 */
      zm_add(z,"H"," HG ",13,1.099,10,104.784, 1,-177.524); /* 14 */
      zm_add(z,"C"," CD1",13,1.536,10,112.415, 1, -61.470); /* 15 */
      zm_add(z,"H","HD11",15,1.097,13,111.851,10,  67.874); /* 16 */
      zm_add(z,"H","HD12",15,1.096,13,111.373,10, -52.905); /* 17 */
      zm_add(z,"H","HD13",15,1.096,13,110.533,10,-172.836); /* 18 */
      zm_add(z,"C"," CD2",13,1.537,10,113.973, 1,  66.025); /* 19 */
      zm_add(z,"H","HD21",19,1.096,13,110.390,10, 171.150); /* 20 */
      zm_add(z,"H","HD22",19,1.097,13,111.714,10,  51.746); /* 21 */
      zm_add(z,"H","HD23",19,1.098,13,112.122,10, -70.080); /* 22 */
      break;
    default:
      msg_error("invalid form of leucine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of lysine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_lys(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.473, 2,112.966, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.894, 2, -60.394); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.566, 2,  56.201); /*  5 */
      zm_add(z,"C"," C  ", 1,1.528, 2,105.747, 3, 116.885); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,127.141, 2, 116.501); /*  7 */
      zm_add(z,"O"," OH ", 6,1.360, 1,110.708, 2, -63.131); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.144, 1,-178.433); /*  9 */
      zm_add(z,"C"," CB ", 1,1.532, 2,108.791, 6, 120.415); /* 10 */
      zm_add(z,"H"," HB2",10,1.100, 1,107.471, 2,  76.413); /* 11 */
      zm_add(z,"H"," HB3",10,1.096, 1,108.544, 2,-168.558); /* 12 */
      zm_add(z,"C"," CG ",10,1.534, 1,114.428, 2, -44.834); /* 13 */
      zm_add(z,"H"," HG2",13,1.101,10,109.359, 1,  55.897); /* 14 */
      zm_add(z,"H"," HG3",13,1.096,10,109.152, 1, -60.534); /* 15 */
      zm_add(z,"C"," CD ",13,1.534,10,112.629, 1, 177.714); /* 16 */
      zm_add(z,"H"," HD2",16,1.097,13,110.222,10,  58.748); /* 17 */
      zm_add(z,"H"," HD3",16,1.102,13,109.443,10, -57.846); /* 18 */
      zm_add(z,"C"," CE ",16,1.530,13,113.161,10,-179.661); /* 19 */
      zm_add(z,"H"," HE2",19,1.107,16,109.062,13,  55.480); /* 20 */
      zm_add(z,"H"," HE3",19,1.098,16,109.107,13, -60.353); /* 21 */
      zm_add(z,"N"," NZ ",19,1.468,16,110.640,13,-178.494); /* 22 */
      zm_add(z,"H"," HZ1",22,1.020,19,109.380,16, -66.872); /* 23 */
      zm_add(z,"H"," HZ2",22,1.019,19,109.761,16, 177.425); /* 24 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.094, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.514, 2,106.580, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.276, 2, -12.589); /*  4 */
      zm_add(z,"H"," HN1", 3,1.069, 1, 99.782, 2, 107.237); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,112.964, 2,-136.798); /*  6 */
      zm_add(z,"C"," C  ", 1,1.574, 2,108.450, 3, 111.939); /*  7 */
      zm_add(z,"O"," O  ", 7,1.243, 1,117.049, 2,  72.077); /*  8 */
      zm_add(z,"O"," OXT", 7,1.269, 1,114.088, 2,-107.226); /*  9 */
      zm_add(z,"C"," CB ", 1,1.534, 2,110.150, 3,-120.773); /* 10 */
      zm_add(z,"H"," HB2",10,1.098, 1,108.841, 2,  73.353); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,109.231, 2,-170.215); /* 12 */
      zm_add(z,"C"," CG ",10,1.534, 1,112.902, 2, -47.658); /* 13 */
      zm_add(z,"H"," HG2",13,1.099,10,109.084, 1,  60.933); /* 14 */
      zm_add(z,"H"," HG3",13,1.093,10,108.652, 1, -55.583); /* 15 */
      zm_add(z,"C"," CD ",13,1.536,10,111.837, 1,-177.745); /* 16 */
      zm_add(z,"H"," HD2",16,1.098,13,109.536,10,  59.941); /* 17 */
      zm_add(z,"H"," HD3",16,1.098,13,110.032,10, -57.684); /* 18 */
      zm_add(z,"C"," CE ",16,1.524,13,110.734,10,-179.120); /* 19 */
      zm_add(z,"H"," HE2",19,1.091,16,112.204,13,  63.692); /* 20 */
      zm_add(z,"H"," HE3",19,1.091,16,111.945,13, -59.133); /* 21 */
      zm_add(z,"N"," NZ ",19,1.515,16,111.314,13,-177.601); /* 22 */
      zm_add(z,"H"," HZ1",22,1.026,19,111.686,16, -59.738); /* 23 */
      zm_add(z,"H"," HZ2",22,1.026,19,111.569,16,-179.702); /* 24 */
      zm_add(z,"H"," HZ3",22,1.026,19,111.613,16,  60.380); /* 25 */
      break;
    default:
      msg_error("invalid form of lysine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of methionine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_met(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.470, 2,113.080, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,109.035, 2, -58.877); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,109.643, 2,  57.973); /*  5 */
      zm_add(z,"C"," C  ", 1,1.528, 2,105.529, 3, 117.501); /*  6 */
      zm_add(z,"O"," O  ", 6,1.210, 1,126.930, 2, 112.079); /*  7 */
      zm_add(z,"O"," OH ", 6,1.358, 1,110.823, 2, -66.902); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.253, 1,-179.093); /*  9 */
      zm_add(z,"C"," CB ", 1,1.535, 2,108.747, 6, 120.427); /* 10 */
      zm_add(z,"H"," HB2",10,1.098, 1,107.420, 2,  74.779); /* 11 */
      zm_add(z,"H"," HB3",10,1.094, 1,108.872, 2,-169.580); /* 12 */
      zm_add(z,"C"," CG ",10,1.531, 1,113.763, 2, -46.138); /* 13 */
      zm_add(z,"H"," HG2",13,1.098,10,110.539, 1,  53.680); /* 14 */
      zm_add(z,"H"," HG3",13,1.093,10,110.073, 1, -66.311); /* 15 */
      zm_add(z,"S"," SD ",13,1.838,10,109.719, 1, 173.585); /* 16 */
      zm_add(z,"C"," CE ",16,1.826,13, 99.477,10, 176.486); /* 17 */
      zm_add(z,"H"," HE1",17,1.095,16,111.391,13,  61.303); /* 18 */
      zm_add(z,"H"," HE2",17,1.094,16,111.192,13, -61.276); /* 19 */
      zm_add(z,"H"," HE3",17,1.093,16,107.066,13,-179.971); /* 20 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.514, 2,106.948, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,113.939, 2,  -6.765); /*  4 */
      zm_add(z,"H"," HN1", 3,1.068, 1, 99.910, 2, 112.009); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,113.521, 2,-131.097); /*  6 */
      zm_add(z,"C"," C  ", 1,1.575, 2,108.844, 3, 112.405); /*  7 */
      zm_add(z,"O"," O  ", 7,1.243, 1,116.844, 2,  67.485); /*  8 */
      zm_add(z,"O"," OXT", 7,1.269, 1,114.102, 2,-111.847); /*  9 */
      zm_add(z,"C"," CB ", 1,1.536, 2,110.192, 3,-120.442); /* 10 */
      zm_add(z,"H"," HB2",10,1.098, 1,108.824, 2,  70.125); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,109.359, 2,-173.029); /* 12 */
      zm_add(z,"C"," CG ",10,1.531, 1,112.331, 2, -50.730); /* 13 */
      zm_add(z,"H"," HG2",13,1.096,10,110.229, 1,  60.916); /* 14 */
      zm_add(z,"H"," HG3",13,1.091,10,109.814, 1, -58.624); /* 15 */
      zm_add(z,"S"," SD ",13,1.840,10,109.793, 1,-179.370); /* 16 */
      zm_add(z,"C"," CE ",16,1.829,13, 99.636,10, 178.169); /* 17 */
      zm_add(z,"H"," HE1",17,1.094,16,110.965,13,  61.718); /* 18 */
      zm_add(z,"H"," HE2",17,1.094,16,110.865,13, -60.473); /* 19 */
      zm_add(z,"H"," HE3",17,1.093,16,107.132,13,-179.372); /* 20 */
      break;
    default:
      msg_error("invalid form of methionine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition phenylalanine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_phe(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.104, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.474, 2,113.232, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.959, 2, -60.293); /*  4 */
      zm_add(z,"H"," HN ", 3,1.019, 1,109.360, 2,  55.976); /*  5 */
      zm_add(z,"C"," C  ", 1,1.528, 2,106.609, 3, 116.494); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,127.283, 2, 126.889); /*  7 */
      zm_add(z,"O"," OH ", 6,1.359, 1,110.390, 2, -54.542); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.237, 1,-177.241); /*  9 */
      zm_add(z,"C"," CB ", 1,1.540, 2,108.900, 6, 120.797); /* 10 */
      zm_add(z,"H"," HB2",10,1.094, 1,108.307, 2,-165.561); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,107.059, 2,  79.348); /* 12 */
      zm_add(z,"C"," CG ",10,1.516, 1,114.073, 2, -41.331); /* 13 */
      zm_add(z,"C"," CD1",13,1.401,10,121.446, 1, -95.539); /* 14 */
      zm_add(z,"H"," HD1",14,1.085,13,119.148,10,   0.395); /* 15 */
      zm_add(z,"C"," CE1",14,1.396,13,120.717,10, 179.627); /* 16 */
      zm_add(z,"H"," HE1",16,1.087,14,119.618,13, 179.836); /* 17 */
      zm_add(z,"C"," CZ ",16,1.396,14,120.341,13,  -0.097); /* 18 */
      zm_add(z,"H"," HZ ",18,1.087,16,120.275,14, 179.884); /* 19 */
      zm_add(z,"C"," CE2",18,1.396,16,119.513,14,   0.114); /* 20 */
      zm_add(z,"H"," HE2",20,1.087,18,120.176,16, 179.587); /* 21 */
      zm_add(z,"C"," CD2",20,1.395,18,119.984,16,   0.043); /* 22 */
      zm_add(z,"H"," HD2",22,1.089,20,119.498,18, 179.214); /* 23 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.513, 2,105.700, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.422, 2, -22.235); /*  4 */
      zm_add(z,"H"," HN1", 3,1.062, 1,100.387, 2,  98.204); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,112.785, 2,-146.462); /*  6 */
      zm_add(z,"C"," C  ", 1,1.575, 2,107.868, 3, 110.995); /*  7 */
      zm_add(z,"O"," O  ", 7,1.244, 1,116.978, 2,  81.085); /*  8 */
      zm_add(z,"O"," OXT", 7,1.267, 1,113.942, 2, -97.896); /*  9 */
      zm_add(z,"C"," CB ", 1,1.545, 2,110.297, 3,-121.908); /* 10 */
      zm_add(z,"H"," HB2",10,1.096, 1,108.282, 2,-142.825); /* 11 */
      zm_add(z,"H"," HB3",10,1.096, 1,109.223, 2, 101.189); /* 12 */
      zm_add(z,"C"," CG ",10,1.519, 1,114.229, 2, -20.077); /* 13 */
      zm_add(z,"C"," CD1",13,1.404,10,121.125, 1, -59.360); /* 14 */
      zm_add(z,"H"," HD1",14,1.086,13,118.497,10,   0.645); /* 15 */
      zm_add(z,"C"," CE1",14,1.396,13,120.536,10,-179.652); /* 16 */
      zm_add(z,"H"," HE1",16,1.087,14,119.652,13,-179.983); /* 17 */
      zm_add(z,"C"," CZ ",16,1.398,14,120.383,13,   0.140); /* 18 */
      zm_add(z,"H"," HZ ",18,1.087,16,120.269,14, 179.916); /* 19 */
      zm_add(z,"C"," CE2",18,1.396,16,119.494,14,  -0.099); /* 20 */
      zm_add(z,"H"," HE2",20,1.087,18,120.192,16,-179.935); /* 21 */
      zm_add(z,"C"," CD2",20,1.397,18,120.071,16,  -0.041); /* 22 */
      zm_add(z,"H"," HD2",22,1.088,20,119.567,18,-179.948); /* 23 */
      break;
    default:
      msg_error("invalid form of phenylalanine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of proline
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_pro(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.099, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"C"," C  ", 1,1.524, 2,106.169, 1,   0.000); /*  3 */
      zm_add(z,"O"," O  ", 3,1.213, 1,125.491, 2, 121.637); /*  4 */
      zm_add(z,"O"," OH ", 3,1.355, 1,111.909, 2, -57.267); /*  5 */
      zm_add(z,"H"," HO ", 5,0.976, 3,106.263, 1, 179.169); /*  6 */
      zm_add(z,"N"," N  ", 1,1.465, 2,110.383, 3, 122.152); /*  7 */
      zm_add(z,"H"," HN ", 7,1.018, 1,109.995, 2, -97.901); /*  8 */
      zm_add(z,"C"," CD ", 7,1.470, 1,107.849, 2, 140.090); /*  9 */
      zm_add(z,"H"," HD2", 9,1.105, 7,113.305, 1,  79.028); /* 10 */
      zm_add(z,"H"," HD3", 9,1.096, 7,110.313, 1,-159.891); /* 11 */
      zm_add(z,"C"," CG ", 9,1.530, 7,102.161, 1, -39.332); /* 12 */
      zm_add(z,"H"," HG2",12,1.095, 9,109.629, 7, -75.822); /* 13 */
      zm_add(z,"H"," HG3",12,1.094, 9,113.133, 7, 163.204); /* 14 */
      zm_add(z,"C"," CB ",12,1.541, 9,102.538, 7,  41.544); /* 15 */
      zm_add(z,"H"," HB2",15,1.093,12,113.384, 9,-150.427); /* 16 */
      zm_add(z,"H"," HB3",15,1.095,12,110.414, 9,  89.487); /* 17 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.091, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"C"," C  ", 1,1.561, 2,110.194, 1,   0.000); /*  3 */
      zm_add(z,"O"," O  ", 3,1.268, 1,114.547, 2, 115.756); /*  4 */
      zm_add(z,"O"," OXT", 3,1.244, 1,115.823, 2, -64.905); /*  5 */
      zm_add(z,"N"," N  ", 1,1.522, 2,108.045, 3, 115.927); /*  6 */
      zm_add(z,"H"," HN1", 6,1.056, 1,100.520, 2,-116.594); /*  7 */
      zm_add(z,"H"," HN2", 6,1.021, 1,112.279, 2,  -0.340); /*  8 */
      zm_add(z,"C"," CD ", 6,1.510, 1,108.515, 2, 123.382); /*  9 */
      zm_add(z,"H"," HD2", 9,1.092, 6,106.980, 1,  91.627); /* 10 */
      zm_add(z,"H"," HD3", 9,1.090, 6,109.475, 1,-149.898); /* 11 */
      zm_add(z,"C"," CG ", 9,1.529, 6,103.372, 1, -26.399); /* 12 */
      zm_add(z,"H"," HG2",12,1.096, 9,110.098, 6, -79.984); /* 13 */
      zm_add(z,"H"," HG3",12,1.093, 9,111.557, 6, 159.994); /* 14 */
      zm_add(z,"C"," CB ",12,1.539, 9,103.166, 6,  38.325); /* 15 */
      zm_add(z,"H"," HB2",15,1.092,12,112.749, 9,-157.433); /* 16 */
      zm_add(z,"H"," HB3",15,1.095,12,110.467, 9,  82.087); /* 17 */
      break;
    default:
      msg_error("invalid form of proline structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of serine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_ser(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.465, 2,113.556, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.018, 1,107.331, 2, -64.511); /*  4 */
      zm_add(z,"H"," HN ", 3,1.017, 1,109.932, 2,  52.403); /*  5 */
      zm_add(z,"C"," C  ", 1,1.521, 2,106.264, 3, 120.905); /*  6 */
      zm_add(z,"O"," O  ", 6,1.211, 1,126.098, 2, 105.455); /*  7 */
      zm_add(z,"O"," OH ", 6,1.355, 1,111.306, 2, -72.946); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.176, 1,-179.738); /*  9 */
      zm_add(z,"C"," CB ", 1,1.524, 2,107.299, 6, 118.109); /* 10 */
      zm_add(z,"H"," HB2",10,1.098, 1,109.765, 2, -60.793); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,108.875, 2,-179.457); /* 12 */
      zm_add(z,"O"," OG ",10,1.427, 1,106.239, 2,  60.180); /* 13 */
      zm_add(z,"H"," HG ",13,0.968,10,107.972, 1, 169.179); /* 14 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.091, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.505, 2,108.536, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,112.856, 2,  20.794); /*  4 */
      zm_add(z,"H"," HN1", 3,1.051, 1,101.938, 2, 136.857); /*  5 */
      zm_add(z,"H"," HN2", 3,1.027, 1,111.202, 2,-101.298); /*  6 */
      zm_add(z,"C"," C  ", 1,1.567, 2,111.818, 3, 117.283); /*  7 */
      zm_add(z,"O"," O  ", 7,1.244, 1,115.638, 2,  53.196); /*  8 */
      zm_add(z,"O"," OXT", 7,1.265, 1,114.048, 2,-129.133); /*  9 */
      zm_add(z,"C"," CB ", 1,1.525, 2,110.627, 3,-118.840); /* 10 */
      zm_add(z,"H"," HB2",10,1.096, 1,108.132, 2, -53.922); /* 11 */
      zm_add(z,"H"," HB3",10,1.099, 1,109.730, 2,-171.887); /* 12 */
      zm_add(z,"O"," OG ",10,1.427, 1,107.445, 2,  67.604); /* 13 */
      zm_add(z,"H"," HG ",13,0.970,10,108.160, 1, 164.903); /* 14 */
      break;
    default:
      msg_error("invalid form of serine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of threonine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_thr(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.107, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.462, 2,114.069, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.018, 1,109.013, 2, -51.587); /*  4 */
      zm_add(z,"H"," HN ", 3,1.017, 1,110.375, 2,  65.790); /*  5 */
      zm_add(z,"C"," C  ", 1,1.522, 2,103.914, 3, 121.493); /*  6 */
      zm_add(z,"O"," O  ", 6,1.217, 1,124.925, 2,  81.990); /*  7 */
      zm_add(z,"O"," OH ", 6,1.350, 1,113.234, 2, -94.927); /*  8 */
      zm_add(z,"H"," HO ", 8,0.977, 6,106.394, 1, 177.652); /*  9 */
      zm_add(z,"C"," CB ", 1,1.554, 2,105.396, 6, 116.771); /* 10 */
      zm_add(z,"H"," HB ",10,1.098, 1,105.952, 2,  66.646); /* 11 */
      zm_add(z,"O"," OG1",10,1.418, 1,110.319, 2, -46.696); /* 12 */
      zm_add(z,"H"," HG1",12,0.975,10,105.623, 1, -60.615); /* 13 */
      zm_add(z,"C"," CG2",10,1.530, 1,113.556, 2,-174.200); /* 14 */
      zm_add(z,"H","HG21",14,1.096,10,110.865, 1,  65.481); /* 15 */
      zm_add(z,"H","HG22",14,1.094,10,110.784, 1, -54.978); /* 16 */
      zm_add(z,"H","HG23",14,1.094,10,109.430, 1,-175.517); /* 17 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.092, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.508, 2,107.043, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,113.955, 2, -14.761); /*  4 */
      zm_add(z,"H"," HN1", 3,1.057, 1,101.344, 2, 104.717); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,113.358, 2,-138.749); /*  6 */
      zm_add(z,"C"," C  ", 1,1.567, 2,108.486, 3, 113.259); /*  7 */
      zm_add(z,"O"," O  ", 7,1.256, 1,115.833, 2,  75.126); /*  8 */
      zm_add(z,"O"," OXT", 7,1.258, 1,115.201, 2,-104.344); /*  9 */
      zm_add(z,"C"," CB ", 1,1.545, 2,107.943, 3,-123.446); /* 10 */
      zm_add(z,"H"," HB ",10,1.097, 1,108.494, 2,  59.572); /* 11 */
      zm_add(z,"O"," OG1",10,1.421, 1,106.928, 2, -55.070); /* 12 */
      zm_add(z,"H"," HG1",12,0.989,10,103.657, 1, -46.798); /* 13 */
      zm_add(z,"C"," CG2",10,1.533, 1,114.146, 2,-178.616); /* 14 */
      zm_add(z,"H","HG21",14,1.095,10,110.634, 1,  59.924); /* 15 */
      zm_add(z,"H","HG22",14,1.098,10,113.107, 1, -62.017); /* 16 */
      zm_add(z,"H","HG23",14,1.094,10,108.857, 1, 178.858); /* 17 */
      break;
    default:
      msg_error("invalid form of threonine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of tryptophan
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_trp(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.105, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.473, 2,113.347, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.864, 2, -60.588); /*  4 */
      zm_add(z,"H"," HN ", 3,1.019, 1,109.428, 2,  55.649); /*  5 */
      zm_add(z,"C"," C  ", 1,1.527, 2,106.484, 3, 116.847); /*  6 */
      zm_add(z,"O"," O  ", 6,1.210, 1,127.297, 2, 123.489); /*  7 */
      zm_add(z,"O"," OH ", 6,1.359, 1,110.562, 2, -57.551); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.214, 1,-177.445); /*  9 */
      zm_add(z,"C"," CB ", 1,1.539, 2,108.883, 6, 120.106); /* 10 */
      zm_add(z,"H"," HB2",10,1.094, 1,108.152, 2,-166.223); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,107.389, 2,  79.072); /* 12 */
      zm_add(z,"C"," CG ",10,1.503, 1,114.099, 2, -42.049); /* 13 */
      zm_add(z,"C"," CD1",13,1.373,10,127.133, 1, -91.262); /* 14 */
      zm_add(z,"H"," HD1",14,1.080,13,129.005,10,   0.530); /* 15 */
      zm_add(z,"N"," NE1",14,1.382,13,110.034,10, 179.405); /* 16 */
      zm_add(z,"H"," HE1",16,1.008,14,125.138,13, 179.738); /* 17 */
      zm_add(z,"C"," CE2",16,1.380,14,109.365,13,  -0.044); /* 18 */
      zm_add(z,"C"," CZ2",18,1.398,16,130.618,14, 179.708); /* 19 */
      zm_add(z,"H"," HZ2",19,1.087,18,121.305,16,   0.239); /* 20 */
      zm_add(z,"C"," CH2",19,1.390,18,117.560,16,-179.734); /* 21 */
      zm_add(z,"H"," HH2",21,1.087,19,119.405,18,-179.983); /* 22 */
      zm_add(z,"C"," CZ3",21,1.410,19,121.129,18,   0.127); /* 23 */
      zm_add(z,"H"," HZ3",23,1.087,21,119.260,19, 179.866); /* 24 */
      zm_add(z,"C"," CE3",23,1.389,21,121.070,19,  -0.117); /* 25 */
      zm_add(z,"H"," HE3",25,1.088,23,120.214,21, 179.847); /* 26 */
      zm_add(z,"C"," CD2",25,1.406,23,119.263,21,   0.002); /* 27 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.515, 2,106.199, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.352, 2, -18.989); /*  4 */
      zm_add(z,"H"," HN1", 3,1.063, 1,100.391, 2, 101.367); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,112.737, 2,-143.084); /*  6 */
      zm_add(z,"C"," C  ", 1,1.575, 2,108.443, 3, 111.336); /*  7 */
      zm_add(z,"O"," O  ", 7,1.244, 1,117.242, 2,  77.818); /*  8 */
      zm_add(z,"O"," OXT", 7,1.268, 1,114.027, 2,-101.309); /*  9 */
      zm_add(z,"C"," CB ", 1,1.541, 2,109.854, 3,-120.776); /* 10 */
      zm_add(z,"H"," HB2",10,1.099, 1,108.676, 2,-159.216); /* 11 */
      zm_add(z,"H"," HB3",10,1.097, 1,108.084, 2,  86.045); /* 12 */
      zm_add(z,"C"," CG ",10,1.508, 1,114.866, 2, -33.909); /* 13 */
      zm_add(z,"C"," CD1",13,1.376,10,128.221, 1, -44.669); /* 14 */
      zm_add(z,"H"," HD1",14,1.080,13,128.207,10,  -0.096); /* 15 */
      zm_add(z,"N"," NE1",14,1.380,13,109.969,10,-179.786); /* 16 */
      zm_add(z,"H"," HE1",16,1.009,14,124.924,13,-179.249); /* 17 */
      zm_add(z,"C"," CE2",16,1.378,14,109.489,13,   0.147); /* 18 */
      zm_add(z,"C"," CZ2",18,1.400,16,130.589,14,-179.929); /* 19 */
      zm_add(z,"H"," HZ2",19,1.087,18,121.141,16,  -0.031); /* 20 */
      zm_add(z,"C"," CH2",19,1.391,18,117.570,16,-179.982); /* 21 */
      zm_add(z,"H"," HH2",21,1.087,19,119.397,18, 179.940); /* 22 */
      zm_add(z,"C"," CZ3",21,1.412,19,121.138,18,  -0.019); /* 23 */
      zm_add(z,"H"," HZ3",23,1.087,21,119.269,19, 179.900); /* 24 */
      zm_add(z,"C"," CE3",23,1.390,21,121.107,19,  -0.000); /* 25 */
      zm_add(z,"H"," HE3",25,1.087,23,120.167,21, 179.798); /* 26 */
      zm_add(z,"C"," CD2",25,1.408,23,119.211,21,  -0.097); /* 27 */
      break;
    default:
      msg_error("invalid form of tryptophan structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of tyrosine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_tyr(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.105, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.474, 2,113.249, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.019, 1,108.921, 2, -60.593); /*  4 */
      zm_add(z,"H"," HN ", 3,1.019, 1,109.402, 2,  55.701); /*  5 */
      zm_add(z,"C"," C  ", 1,1.527, 2,106.567, 3, 116.482); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,127.327, 2, 126.188); /*  7 */
      zm_add(z,"O"," OH ", 6,1.359, 1,110.423, 2, -55.180); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.223, 1,-177.254); /*  9 */
      zm_add(z,"C"," CB ", 1,1.540, 2,108.857, 6, 120.791); /* 10 */
      zm_add(z,"H"," HB2",10,1.094, 1,108.243, 2,-165.790); /* 11 */
      zm_add(z,"H"," HB3",10,1.098, 1,107.019, 2,  79.368); /* 12 */
      zm_add(z,"C"," CG ",10,1.516, 1,114.307, 2, -41.440); /* 13 */
      zm_add(z,"C"," CD1",13,1.400,10,121.745, 1, -94.604); /* 14 */
      zm_add(z,"H"," HD1",14,1.085,13,119.291,10,   0.528); /* 15 */
      zm_add(z,"C"," CE1",14,1.395,13,121.202,10, 179.756); /* 16 */
      zm_add(z,"H"," HE1",16,1.089,14,119.947,13, 179.836); /* 17 */
      zm_add(z,"C"," CZ ",16,1.398,14,120.079,13,  -0.078); /* 18 */
      zm_add(z,"O"," OH ",18,1.369,16,122.815,14, 179.896); /* 19 */
      zm_add(z,"H"," HH ",19,0.970,18,108.751,16,  -0.230); /* 20 */
      zm_add(z,"C"," CE2",18,1.398,16,119.657,14,   0.099); /* 21 */
      zm_add(z,"H"," HE2",21,1.086,18,119.065,16, 179.516); /* 22 */
      zm_add(z,"C"," CD2",21,1.392,18,119.532,16,   0.049); /* 23 */
      zm_add(z,"H"," HD2",23,1.089,21,118.797,18, 179.224); /* 24 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.514, 2,105.724, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,114.403, 2, -22.209); /*  4 */
      zm_add(z,"H"," HN1", 3,1.061, 1,100.446, 2,  98.262); /*  5 */
      zm_add(z,"H"," HN2", 3,1.023, 1,112.699, 2,-146.374); /*  6 */
      zm_add(z,"C"," C  ", 1,1.575, 2,108.032, 3, 110.930); /*  7 */
      zm_add(z,"O"," O  ", 7,1.244, 1,117.088, 2,  81.164); /*  8 */
      zm_add(z,"O"," OXT", 7,1.267, 1,113.983, 2, -97.880); /*  9 */
      zm_add(z,"C"," CB ", 1,1.545, 2,110.241, 3,-121.704); /* 10 */
      zm_add(z,"H"," HB2",10,1.096, 1,108.274, 2,-146.147); /* 11 */
      zm_add(z,"H"," HB3",10,1.096, 1,108.987, 2,  98.136); /* 12 */
      zm_add(z,"C"," CG ",10,1.519, 1,114.499, 2, -22.765); /* 13 */
      zm_add(z,"C"," CD1",13,1.402,10,121.648, 1, -60.160); /* 14 */
      zm_add(z,"H"," HD1",14,1.086,13,118.563,10,   1.006); /* 15 */
      zm_add(z,"C"," CE1",14,1.395,13,121.138,10,-179.485); /* 16 */
      zm_add(z,"H"," HE1",16,1.088,14,120.106,13,-179.887); /* 17 */
      zm_add(z,"C"," CZ ",16,1.400,14,120.036,13,   0.227); /* 18 */
      zm_add(z,"O"," OH ",18,1.369,16,122.772,14, 179.849); /* 19 */
      zm_add(z,"H"," HH ",19,0.971,18,109.163,16,  -0.403); /* 20 */
      zm_add(z,"C"," CE2",18,1.399,16,119.629,14,  -0.196); /* 21 */
      zm_add(z,"H"," HE2",21,1.086,18,119.286,16,-179.939); /* 22 */
      zm_add(z,"C"," CD2",21,1.394,18,119.692,16,  -0.000); /* 23 */
      zm_add(z,"H"," HD2",23,1.088,21,118.855,18, 179.990); /* 24 */
      break;
    default:
      msg_error("invalid form of tyrosine structure requested",1);
    }
  return(z);
  }

/* Create Z-matrix list definition of valine
 
   form - protonation form of the amino acid */
struct list* aacid_geom_def_val(short form) {
  struct list *z;
  zmt_add_fce zm_add;
  /* initialization */
  z = list_alloc();
  zm_add = aacid_geom_def_add;
  /* create structure */
  switch (form) {
    case AA_FORM_NEUTRAL: /* neutral form (NH2,COOH) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.108, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.474, 2,112.582, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.017, 1,109.136, 2, -53.619); /*  4 */
      zm_add(z,"H"," HN ", 3,1.018, 1,108.950, 2,  62.149); /*  5 */
      zm_add(z,"C"," C  ", 1,1.529, 2,105.914, 3, 115.874); /*  6 */
      zm_add(z,"O"," O  ", 6,1.209, 1,127.490, 2, 119.998); /*  7 */
      zm_add(z,"O"," OH ", 6,1.361, 1,110.564, 2, -60.360); /*  8 */
      zm_add(z,"H"," HO ", 8,0.976, 6,106.072, 1,-177.937); /*  9 */
      zm_add(z,"C"," CB ", 1,1.543, 2,108.230, 6, 119.829); /* 10 */
      zm_add(z,"H"," HB ",10,1.097, 1,106.885, 2,-165.682); /* 11 */
      zm_add(z,"C"," CG1",10,1.537, 1,111.039, 2, -47.304); /* 12 */
      zm_add(z,"H","HG11",12,1.093,10,111.650, 1, -58.389); /* 13 */
      zm_add(z,"H","HG12",12,1.096,10,110.338, 1,-178.265); /* 14 */
      zm_add(z,"H","HG13",12,1.099,10,110.985, 1,  62.798); /* 15 */
      zm_add(z,"C"," CG2",10,1.536, 1,111.480, 2,  76.087); /* 16 */
      zm_add(z,"H","HG21",16,1.096,10,110.124, 1,-177.413); /* 17 */
      zm_add(z,"H","HG22",16,1.099,10,111.484, 1, -58.541); /* 18 */
      zm_add(z,"H","HG23",16,1.095,10,111.868, 1,  63.253); /* 19 */
      break;
    case AA_FORM_ZWITTERION: /* protonated form (NH3+,COO-) */
      zm_add(z,"C"," CA ", 1,0.000, 1,  0.000, 1,   0.000); /*  1 */
      zm_add(z,"H"," HA ", 1,1.093, 1,  0.000, 1,   0.000); /*  2 */
      zm_add(z,"N"," N  ", 1,1.517, 2,107.922, 1,   0.000); /*  3 */
      zm_add(z,"H"," H  ", 3,1.022, 1,113.407, 2,  10.380); /*  4 */
      zm_add(z,"H"," HN1", 3,1.068, 1, 99.571, 2, 127.033); /*  5 */
      zm_add(z,"H"," HN2", 3,1.022, 1,114.504, 2,-114.260); /*  6 */
      zm_add(z,"C"," C  ", 1,1.577, 2,109.529, 3, 112.117); /*  7 */
      zm_add(z,"O"," O  ", 7,1.242, 1,117.204, 2,  51.905); /*  8 */
      zm_add(z,"O"," OXT", 7,1.271, 1,113.906, 2,-127.908); /*  9 */
      zm_add(z,"C"," CB ", 1,1.546, 2,109.938, 3,-120.640); /* 10 */
      zm_add(z,"H"," HB ",10,1.100, 1,107.184, 2, 177.922); /* 11 */
      zm_add(z,"C"," CG1",10,1.537, 1,111.510, 2, -64.000); /* 12 */
      zm_add(z,"H","HG11",12,1.090,10,111.627, 1, -57.048); /* 13 */
      zm_add(z,"H","HG12",12,1.096,10,109.529, 1,-178.138); /* 14 */
      zm_add(z,"H","HG13",12,1.097,10,110.688, 1,  63.135); /* 15 */
      zm_add(z,"C"," CG2",10,1.540, 1,111.747, 2,  59.010); /* 16 */
      zm_add(z,"H","HG21",16,1.095,10,109.903, 1,-179.700); /* 17 */
      zm_add(z,"H","HG22",16,1.097,10,110.639, 1, -60.614); /* 18 */
      zm_add(z,"H","HG23",16,1.097,10,113.734, 1,  60.747); /* 19 */
      break;
    default:
      msg_error("invalid form of valine structure requested",1);
    }
  return(z);
  }

/* -------------------------------------------------------------------------- */

/* Create structure of a single amino acid (list of Z-matrix records)
 
   id   - internal ID of the amino acid
   form - protonation form of the amino acid */
struct list* aacid_geom_def(short id, short form) {
  short pf = AA_FORM_NEUTRAL;
  struct list *z = NULL;
  /* protonation form */
  switch (form) {
    case AA_FORM_NEUTRAL:
    case AA_FORM_NTER_N:
    case AA_FORM_CTER_N: 
    case AA_FORM_CHAIN_N:
      pf = AA_FORM_NEUTRAL; break;
    case AA_FORM_ZWITTERION:
    case AA_FORM_NTER_P:
    case AA_FORM_CTER_P:
    case AA_FORM_CHAIN_P:
      pf = AA_FORM_ZWITTERION; break;
    default:
      msg_error("invalid structure-form ID",1);
    }
  /* single amino-acid structure */
  switch (id) {
    case AA_ALA: z = aacid_geom_def_ala(pf); break;
    case AA_ARG: z = aacid_geom_def_arg(pf); break;
    case AA_ASN: z = aacid_geom_def_asn(pf); break;
    case AA_ASP: z = aacid_geom_def_asp(pf); break;
    case AA_CYS: z = aacid_geom_def_cys(pf); break;
    case AA_GLU: z = aacid_geom_def_glu(pf); break;
    case AA_GLN: z = aacid_geom_def_gln(pf); break;
    case AA_GLY: z = aacid_geom_def_gly(pf); break;
    case AA_HIS: z = aacid_geom_def_his(pf); break;
    case AA_ILE: z = aacid_geom_def_ile(pf); break;
    case AA_LEU: z = aacid_geom_def_leu(pf); break;
    case AA_LYS: z = aacid_geom_def_lys(pf); break;
    case AA_MET: z = aacid_geom_def_met(pf); break;
    case AA_PHE: z = aacid_geom_def_phe(pf); break;
    case AA_PRO: z = aacid_geom_def_pro(pf); break;
    case AA_SER: z = aacid_geom_def_ser(pf); break;
    case AA_THR: z = aacid_geom_def_thr(pf); break;
    case AA_TRP: z = aacid_geom_def_trp(pf); break;
    case AA_TYR: z = aacid_geom_def_tyr(pf); break;
    case AA_VAL: z = aacid_geom_def_val(pf); break;
    default:
      msg_error_f("single amino-acid structure of #%d not defined",1,id);
    }
  /* structure modifications */
  aacid_geom_mod(z,id,form);
  return(z);
  }

/* -------------------------------------------------------------------------- */
